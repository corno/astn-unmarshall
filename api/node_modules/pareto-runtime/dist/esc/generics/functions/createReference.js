"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createReference = void 0;
function createReference(propertyName, annotatedName, defaultName, contextAnnotation, lookup, registrater) {
    var t = null;
    var name = annotatedName !== null
        ? annotatedName.value
        : defaultName;
    registrater.register(function () {
        return lookup.with(name, function (entry) {
            t = entry;
            return null;
        }, function (keys) {
            return {
                message: "".concat(propertyName, " '").concat(name, "' not found, choose from ").concat(keys.map(function (x) { return "'".concat(x, "'"); }).join(", ")),
                annotation: annotatedName !== null
                    ? annotatedName.annotation
                    : contextAnnotation,
            };
        });
    });
    return {
        get: function () {
            if (t === null) {
                throw new Error("UNEXPECTED: not resolved");
            }
            return t;
        },
        name: name,
    };
}
exports.createReference = createReference;
